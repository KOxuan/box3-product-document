# 组件生命周期

该生命周期参考 cocos 引擎的生命周期。

![](https://static.codemao.cn/pickduck/SkSU5p821e.svg?hash=Fj7ld7OvQmLlDIGG9EuPM2R0dZW0)

组件生命周期是指脚本组件从创建到销毁的整个过程中所经历的一系列预设事件。这些事件定义了组件在不同阶段的行为，帮助创作者有效管理游戏逻辑和资源。以下是组件生命周期的详细解释：

### 1. 初始化和准备阶段

- **onLoad()**：组件实例化时调用。这是进行资源加载和数据初始化的最佳时机。可以将其视为组件的"出生"时刻，此时组件开始准备进入游戏世界。

- **start()**：组件初次加载完成后调用。这是设置初始状态、注册事件监听器等操作的理想时机。可以将其视为组件"正式上岗"的时刻。

### 2. 启用阶段

- **onEnable()**：组件被启用时调用。通常用于注册事件监听器、启动计时器等需要在组件激活时执行的操作。

### 3. 更新阶段

- **update(deltaTime)**：每帧调用一次，用于实现帧更新逻辑。`deltaTime` 参数表示自上一帧以来经过的时间（毫秒），可用于时间相关计算，如动画、移动等基于时间的操作。这是游戏逻辑的核心部分，每一帧都在此更新。

### 4. 禁用和销毁阶段

- **onDisable()**：组件被禁用时调用。通常用于注销事件监听器、暂停动画或计时器等操作。可以理解为组件"暂时下岗"，不再参与游戏世界的交互。

- **onDestroy()**：组件被销毁时调用。这是进行资源清理的最后机会，如释放内存、注销全局事件监听器等。可以将其视为组件的"终结"时刻，它将从游戏世界中彻底移除。

总的来说，组件生命周期类似于组件的"生命旅程"。通过合理利用这些生命周期回调函数，创作者可以更加有序地管理游戏逻辑和资源，确保游戏流畅运行。每个阶段都有其特定的用途和意义，正确理解并应用这些生命周期方法对于开发高质量游戏至关重要。

**注意：** 以下所有生命周期回调函数的实现都是**可选的**。

## onLoad

`onLoad` 回调函数在组件实例化时触发，会在 `start` 和 `onEnable` 第一次调用之前执行。这是初始化组件内部状态的理想位置。

## start

`start` 回调函数在组件初始化完成时触发，会在 `update` 第一次执行之前调用。通常我们在 `start` 阶段进行依赖其他组件的初始化操作。

## update

`update` 回调函数在游戏世界的每一帧（30 FPS）中触发，用于实现需要持续更新的游戏逻辑。

**参数：** `deltaTime` - 两次更新之间的时间间隔，单位为毫秒。

## onDestroy

`onDestroy` 回调函数在执行 `destroy` 方法后，且在 `update` 最后一次执行之后调用。系统会激活 `onDestroy` 回调并在当前帧结束时统一回收组件资源。

## onEnable

**组件初始化阶段：** `onEnable` 回调在执行 `start` 回调后、`update` 开始执行之前调用。

**组件启用阶段：** 当组件的 `enabled` 属性从 `false` 变为 `true` 时，系统会触发 `onEnable` 回调。

启用后，`update` 开始正常执行。

**注意：** 如果设置的 `enabled` 属性值与当前值相同，则不会触发 `onEnable` 回调。

## onDisable

**组件销毁阶段：** `onDisable` 回调在执行 `onDestroy` 回调前、`update` 最后一次执行之后调用。

**组件禁用阶段：** 当组件的 `enabled` 属性从 `true` 变为 `false` 时，系统会触发 `onDisable` 回调。

禁用后，`update` 将暂停执行。

**注意：** 如果设置的 `enabled` 属性值与当前值相同，则不会触发 `onDisable` 回调。
