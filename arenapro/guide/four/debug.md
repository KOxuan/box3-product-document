# 🐞 Debug 模式详解

在开发游戏或应用时，Debug 模式是一个非常重要的工具，它能够帮助创作者快速定位并解决问题。

## 📊 代码生成对比

<table>
  <tr>
    <th width="150">模式</th>
    <th>代码特点</th>
    <th>示例</th>
  </tr>
  <tr>
    <td><b>生产模式</b><br>(Debug关闭)</td>
    <td>生成的代码经过<b>压缩和混淆</b>，体积小，不可读</td>
    <td><img src="/QQ20241202-222614.png" alt="生产模式代码示例" /></td>
  </tr>
  <tr>
    <td><b>Debug模式</b><br>(Debug开启)</td>
    <td>生成的代码<b>未压缩和混淆</b>，便于阅读和调试</td>
    <td><img src="/QQ20241202-222905.png" alt="Debug模式代码示例" /></td>
  </tr>
</table>

## 🔍 核心功能

### 开发阶段支持

| 功能       | 说明                                               |
| ---------- | -------------------------------------------------- |
| 代码可读性 | Debug 模式生成未经压缩和混淆的代码，便于阅读和理解 |
| 定位问题   | 直接在神岛环境/VSCode 中进行调试                   |
| 行号映射   | 保留原始代码行号，方便追踪问题源头                 |

:::info
**📚 使用场景**：Debug 模式主要用于`开发阶段`，不建议在生产环境中使用。
:::

### 错误处理增强

| 功能         | 说明                                 |
| ------------ | ------------------------------------ |
| 详细错误信息 | 提供完整的错误文本和上下文           |
| 堆栈跟踪     | 显示完整的调用堆栈，便于定位错误来源 |
| 变量检查     | 保留变量名称，便于检查变量状态       |

### 性能与安全考量

:::warning
**⚠️ 注意事项**：由于 Debug 模式生成的代码体积较大且未经优化，在生产环境中使用可能会带来性能上的影响及潜在的安全风险。我们强烈建议仅在开发阶段启用 Debug 模式，并在发布前切换到生产模式。
:::

## ⚙️ 配置指南

### 配置文件修改

打开`dao3.config.json`文件，找到相关配置部分：

```json
{
  "ArenaPro": {
    "file": {
      "typescript": {
        "server": {
          "development": true // 服务端开启debug代码
        },
        "client": {
          "development": true // 客户端开启debug代码
        },
        "developmentAll": null // 开启服务端和客户端debug代码，优先级最高，null表示忽略该属性。
      }
    }
  }
}
```

### 配置参数说明

| 参数             | 位置   | 说明                                             |
| ---------------- | ------ | ------------------------------------------------ |
| `development`    | server | 设置为`true`开启服务端调试模式                   |
| `development`    | client | 设置为`true`开启客户端调试模式                   |
| `developmentAll` | 根级别 | 设为`true`同时开启服务端和客户端调试，优先级最高 |

### 构建与验证步骤

| 步骤 | 操作说明                                         |
| ---- | ------------------------------------------------ |
| 1    | 修改配置后保存`dao3.config.json`文件             |
| 2    | 重新构建项目生成新的调试版本                     |
| 3    | 检查`dist`文件夹中的 JS 文件确认是否为未压缩格式 |

## 🔧 调试流程

### 基础调试步骤

1. 打开神岛创作端并加载项目
2. 运行地图查看效果
3. 通过控制台查看错误信息
4. 利用错误信息中的链接定位问题源码

### 最佳实践

| 建议         | 说明                                               |
| ------------ | -------------------------------------------------- |
| 保持源码一致 | 避免直接修改生成的 JS 文件，应修改 TypeScript 源码 |
| 记得重新构建 | 修改源码后需重新构建才能生效                       |
| 发布前关闭   | 发布前将 Debug 模式关闭，切换到生产模式            |

:::tip
**💡 提示**：你可以在开发时使用 Debug 模式，在准备发布时切换到生产模式，获得最佳的开发体验和运行性能。
:::
