# å¦‚ä½•é˜…è¯» API æ‰‹å†Œ

APIï¼ˆApplication Programming Interfaceï¼Œåº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼‰æ˜¯ä¸åŒè½¯ä»¶åº”ç”¨ç¨‹åºä¹‹é—´çš„é€šä¿¡æ¡¥æ¢ã€‚

åœ¨æœ¬ç« èŠ‚ä¸­ï¼Œå°†ä¼šæŠŠå­¦åˆ°çš„ JavaScript è¯­è¨€ï¼Œå¹¶ç»“åˆç¥å²› APIï¼Œå…±åŒè¸ä¸Šåˆ›ä½œæ¸¸æˆçš„æ—…ç¨‹ã€‚

åœ¨æ­£å¼å¯ç¨‹ä¹‹å‰ï¼ŒæŒæ¡å¦‚ä½•æœ‰æ•ˆé˜…è¯»å¹¶ç†è§£ API æ‰‹å†Œå°†æ˜¯ä¸å¯æˆ–ç¼ºçš„ä¸€è¯¾ï¼Œå®ƒå°†ä¸ºä½ çš„æ¸¸æˆå¼€å‘ä¹‹è·¯å¥ å®šåšå®çš„åŸºç¡€ã€‚

ç¥å²› API æ‰‹å†Œï¼š[https://docs.dao3.fun/api/](https://docs.dao3.fun/api/)

:::info
æ‰‹å†Œè¿ç”¨äº†å…³äº`TypeScript`è¯­è¨€çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ç« èŠ‚ä»‹ç»å®ƒï¼Œè¿™å±äºè¿›é˜¶ç« èŠ‚ã€‚

ä½ å¯ä»¥å­¦å®Œ`TypeScript`è¯­è¨€ç« èŠ‚åï¼Œå†å›æ¥çœ‹è¿™é‡Œã€‚ä¼šæœ‰ä¸åŒçš„æ”¶è·ã€‚

æ‰‹å†Œä¸­ `declare`å…³é”®å­—ï¼Œè¡¨ç¤ºè¯¥å˜é‡æˆ–ç±»æ˜¯ç¼–è¯‘æ—¶å®šä¹‰çš„ï¼Œè€Œä¸æ˜¯è¿è¡Œæ—¶å®šä¹‰çš„ã€‚
:::

æˆ‘ä»¬æ¥ä¸‹æ¥ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œå¸¦ä½ çœ‹æ‡‚ API æ‰‹å†Œã€‚

## ğŸŒ æ¸¸æˆä¸–ç•Œ

ä»[`ğŸŒæ¸¸æˆä¸–ç•Œ`](https://docs.dao3.fun/api/GameWorld/)ç•Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š

```typescript
declare const world: GameWorld;
declare class GameWorld {
  //...
}
```

1. **`declare const world: GameWorld;`**ï¼š

   - è¿™è¡Œä»£ç å£°æ˜äº†ä¸€ä¸ªåä¸º`world`çš„å¸¸é‡ï¼Œå…¶ç±»å‹ä¸º`GameWorld`ã€‚è¿™æ„å‘³ç€åœ¨è„šæœ¬ä¸­å·²ç»å­˜åœ¨äº†ä¸€ä¸ª`GameWorld`ç±»å‹çš„`world`å¸¸é‡ã€‚

2. **`declare class GameWorld { ... }`**ï¼š
   - è¿™è¡Œå£°æ˜äº†ä¸€ä¸ªåä¸º`GameWorld`çš„ç±»ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¿é—®`world`å¸¸é‡æ¥è®¿é—®`GameWorld`ã€‚

## å±æ€§

ä»[`projectName`](https://docs.dao3.fun/api/GameWorld/mapInfo.html#projectName)ç•Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š

![](/QQ20240925-143355.png)

è¿™æ®µä»£ç æ˜¯ä¸€ä¸ªç±»å‹å£°æ˜ä»£ç ã€‚å®ƒå£°æ˜äº†ä¸€ä¸ªåä¸º`projectName`çš„`åªè¯»`å±æ€§ï¼Œå…¶ç±»å‹ä¸º`string`ã€‚

è¿™æ„å‘³ç€`projectName`æ˜¯ä¸€ä¸ªè¿”å›çš„æ•°æ®æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚

æ‰€ä»¥ï¼Œæˆ‘ä»¬é€šè¿‡`world.projectName`å¯ä»¥è·å–å½“å‰åœ°å›¾çš„åç§°ã€‚

```javascript
console.log(world.projectName);
```

![](/QQ20240925-151110.png)

## æ–¹æ³•

ä»[`onPlayerJoin`](https://docs.dao3.fun/api/GameWorld/playerJL.html#onPlayerJoin)ç•Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š

![](/QQ20240925-172033.png)

è¿™æ®µä»£ç æ˜¯ä¸€ä¸ªå‡½æ•°å£°æ˜çš„ç¤ºä¾‹ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ªåä¸º`onPlayerJoin`çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ª`GameEventHandlerToken`ç±»å‹çš„å€¼ã€‚ä¸‹é¢æ˜¯å¯¹è¿™ä¸ªå£°æ˜çš„è¯¦ç»†è§£é‡Šï¼š

- `handler:(event:GameEntityEvent)=>void`ï¼šè¿™æ˜¯`onPlayerJoin`å‡½æ•°çš„å”¯ä¸€å‚æ•°ï¼Œåä¸º`handler`ã€‚å®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ç±»å‹ï¼Œæ„å‘³ç€ä½ éœ€è¦ä¼ é€’ä¸€ä¸ªå‡½æ•°ç»™`onPlayerJoin`ã€‚è¿™ä¸ª`handler`å‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•°`event`ï¼Œå…¶ç±»å‹ä¸º`GameEntityEvent`ï¼Œå¹¶ä¸”æ²¡æœ‰è¿”å›å€¼ï¼ˆè¿”å›ç±»å‹ä¸º`void`ï¼‰ã€‚
  - `GameEntityEvent`ï¼šè¿™æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰ç±»å‹ï¼Œç”¨äºè¡¨ç¤ºä¸æ¸¸æˆå®ä½“ç›¸å…³çš„äº‹ä»¶ã€‚è¿™ä¸ªç±»å‹åŒ…å«äº†äº‹ä»¶å‘ç”Ÿæ—¶æ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯ã€‚
  - `void`ï¼šè¡¨ç¤º`handler`å‡½æ•°ä¸è¿”å›ä»»ä½•å€¼ã€‚
- `GameEventHandlerToken`ï¼š`onPlayerJoin`å‡½æ•°è¿”å›ä¸€ä¸ª`GameEventHandlerToken`ç±»å‹çš„å€¼ã€‚è¿™ä¸ªç±»å‹æ˜¯ä¸€ä¸ªç”¨äºæ ‡è¯†æˆ–ç®¡ç†äº‹ä»¶å¤„ç†ç¨‹åºçš„ä»¤ç‰Œï¼ˆtokenï¼‰ã€‚åœ¨äº‹ä»¶é©±åŠ¨çš„ç¼–ç¨‹ä¸­ï¼Œè¿™ç§ä»¤ç‰Œé€šå¸¸ç”¨äºå–æ¶ˆæˆ–ç®¡ç†äº‹ä»¶ç›‘å¬å™¨ã€‚å®ƒå…è®¸ä½ ä¹‹åæ¥ç§»é™¤æˆ–ç¦ç”¨è¿™ä¸ªç‰¹å®šçš„`handler`å‡½æ•°ã€‚

## æ¥å£

æˆ‘ä»¬ç‚¹å‡»`GameEntityEvent`ï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š

![](/QQ20240925-173126.png)

è¿™æ®µä»£ç æè¿°äº†ä¸€ä¸ªåä¸º`GameEntityEvent`çš„æ¥å£ï¼ˆInterfaceï¼‰ï¼Œè¯¥æ¥å£ç”¨äºå®šä¹‰ä¸€ä¸ªç‰¹å®šç±»å‹çš„äº‹ä»¶ï¼Œè¿™ä¸ªäº‹ä»¶åœ¨æ¸¸æˆä¸­åˆ›å»ºæˆ–é”€æ¯å®ä½“æ—¶è¢«è§¦å‘ã€‚

å…·ä½“æ¥è¯´ï¼Œ`GameEntityEvent`æ¥å£å®šä¹‰äº†ä¸¤ä¸ªå±æ€§ï¼š

1. **entity**ï¼ˆç±»å‹ï¼š`GameEntity`ï¼‰ï¼šè¿™ä¸ªå±æ€§è¡¨ç¤ºäº†è¢«åˆ›å»ºæˆ–é”€æ¯çš„å®ä½“ã€‚`GameEntity`æ˜¯ç©å®¶å®ä½“æœ¬èº«ä¸€ä¸ªç±»ï¼Œå®ƒå®šä¹‰äº†æ¸¸æˆç©å®¶å®ä½“çš„å±æ€§å’Œæ–¹æ³•ã€‚

2. **tick**ï¼ˆç±»å‹ï¼š`number`ï¼‰ï¼šè¿™ä¸ªå±æ€§è¡¨ç¤ºäº‹ä»¶å‘ç”Ÿçš„æ—¶é—´ã€‚åœ¨æ¸¸æˆå¼€å‘ä¸­ï¼Œ`tick`é€šå¸¸æŒ‡çš„æ˜¯æ¸¸æˆå¾ªç¯ä¸­çš„æŸä¸€æ—¶åˆ»æˆ–å¸§æ•°ï¼Œå®ƒå…è®¸åˆ›ä½œè€…çŸ¥é“äº‹ä»¶æ˜¯åœ¨æ¸¸æˆçš„å“ªä¸ªé˜¶æ®µå‘ç”Ÿçš„ã€‚è¿™ä¸ªä¿¡æ¯å¯¹äºè°ƒè¯•ã€åŠ¨ç”»åŒæ­¥ã€æ—¶é—´ç®¡ç†ç­‰æ–¹é¢éƒ½éå¸¸æœ‰ç”¨ã€‚

å…³äº`GameEntity`ç±»å…·ä½“å†…å®¹å¯ä»¥æŸ¥çœ‹ï¼š[`ğŸ‘¤æ¸¸æˆç©å®¶`](https://docs.dao3.fun/api/GamePlayerEntity/)

æ‰€ä»¥ï¼Œæˆ‘ä»¬é€šè¿‡`world.onPlayerJoin`è®¾ç½®å½“ç©å®¶åŠ å…¥æ—¶ï¼Œæ‰§è¡Œçš„æ“ä½œã€‚

```javascript
world.onPlayerJoin(({ entity }) => {
  console.log(`ä½ å¥½ï¼Œ${entity.player.name}`);
});
```

![](/QQ20240925-173602.png)

## æšä¸¾

åœ¨ä»[`ğŸ‘¤æ¸¸æˆç©å®¶`](https://docs.dao3.fun/api/GamePlayerEntity/)ä¸­ï¼Œæœ‰ä¸€ä¸ª[`cameraMode`](https://docs.dao3.fun/api/GamePlayerEntity/camera.html#cameraMode)ç•Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š

![](/QQ20240925-183504.png)

è¿™æ®µä»£ç çš„å«ä¹‰æ˜¯ï¼š

- `cameraMode`ï¼šè¿™æ˜¯ä¸€ä¸ªå±æ€§åï¼Œç”¨äºå¼•ç”¨æˆ–å­˜å‚¨ä¸ç›¸æœºæ¨¡å¼ç›¸å…³çš„ä¿¡æ¯ã€‚
- `GameCameraMode`ï¼šè¿™æ˜¯ä¸€ä¸ªæšä¸¾ï¼ˆEnumï¼‰ï¼Œå®ƒå®šä¹‰äº†æ¸¸æˆä¸­ç›¸æœºå¯ä»¥å¤„äºçš„ä¸åŒæ¨¡å¼ã€‚

æˆ‘ä»¬ç‚¹å‡»`GameCameraMode`ï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š

![](/QQ20240925-183810.png)

è¿™æ®µä»£ç å®šä¹‰äº†ä¸€ä¸ªåä¸º`GameCameraMode`çš„æšä¸¾ï¼Œå®ƒç”¨äºè¡¨ç¤ºæ¸¸æˆä¸­ç©å®¶çš„ç›¸æœºè§†è§’æ¨¡å¼ã€‚

ä»¥ä¸‹æ˜¯`GameCameraMode`æšä¸¾çš„è¯¦ç»†è§£é‡Šï¼š

- **FIXED**ï¼šè¿™ä¸ªæˆå‘˜è¡¨ç¤ºç¬¬ä¸‰äººç§°å›ºå®šè§†è§’æ¨¡å¼ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œç›¸æœºä½äºä¸€ä¸ªå›ºå®šçš„ä½ç½®ï¼Œå¹¶ä¸”ä¸éšç©å®¶çš„ç§»åŠ¨è€Œç§»åŠ¨ï¼Œä¸ºç©å®¶æä¾›äº†ä¸€ä¸ªä»å¤–éƒ¨è§‚å¯Ÿæ¸¸æˆä¸–ç•Œçš„è§†è§’ã€‚

- **FOLLOW**ï¼šè¿™ä¸ªæˆå‘˜è¡¨ç¤ºç¬¬ä¸‰äººç§°è·Ÿéšè§†è§’æ¨¡å¼ï¼Œå¹¶ä¸”è¢«æ ‡è®°ä¸º`é»˜è®¤æ¨¡å¼`ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œç›¸æœºä¼šè·Ÿéšç©å®¶çš„ç§»åŠ¨ï¼Œä½†å§‹ç»ˆä¿æŒåœ¨ç©å®¶åé¢çš„ä¸€å®šè·ç¦»å’Œè§’åº¦ï¼Œæä¾›ç±»ä¼¼ç”µå½±æ‘„å½±æœºçš„æ•ˆæœã€‚

- **FPS**ï¼šè¿™ä¸ªæˆå‘˜è¡¨ç¤ºç¬¬ä¸€äººç§°è§†è§’æ¨¡å¼ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œç›¸æœºè§†è§’ä¸ç©å®¶çš„è§†è§’å®Œå…¨ä¸€è‡´ï¼Œå°±åƒç©å®¶ç›´æ¥é€šè¿‡è§’è‰²çš„çœ¼ç›åœ¨çœ‹ä¸–ç•Œä¸€æ ·ï¼Œè¿™æ˜¯è®¸å¤šå°„å‡»æ¸¸æˆå’Œç¬¬ä¸€äººç§°å†’é™©æ¸¸æˆæ‰€é‡‡ç”¨çš„è§†è§’ã€‚

- **RELATIVE**ï¼šè¿™ä¸ªæˆå‘˜è¡¨ç¤ºç›¸å¯¹äºç©å®¶ä½ç½®çš„ç¬¬ä¸‰äººç§°è§†è§’æ¨¡å¼ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œç›¸æœºçš„ä½ç½®å¯èƒ½ä¼šæ ¹æ®ç©å®¶çš„ä½ç½®è¿›è¡ŒæŸç§å½¢å¼çš„åŠ¨æ€è°ƒæ•´ã€‚å®ƒç”¨äºåœ¨ä¿æŒç¬¬ä¸‰äººç§°è§†è§’çš„åŒæ—¶ï¼Œæ ¹æ®ç©å®¶çš„ç§»åŠ¨æˆ–æœå‘æ¥è°ƒæ•´ç›¸æœºçš„ä½ç½®æˆ–è§’åº¦ã€‚

æ‰€ä»¥ï¼Œæˆ‘ä»¬é€šè¿‡`entity.player.cameraMode`è®¾ç½®ç©å®¶æ‘„åƒæœºè§†è§’ ã€‚

```javascript
world.onPlayerJoin(({ entity }) => {
  // å½“ç©å®¶åŠ å…¥åœ°å›¾æ—¶å€™ï¼Œè®¾ç½®ç©å®¶æ‘„åƒæœºä¸ºç¬¬ä¸€äººç§°è§†è§’
  entity.player.cameraMode = GameCameraMode.FPS;
});
```
